<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Virginia Legends Cricket 2025</title>
<style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #f5f7fa, #c3cfe2);
      padding: 10px;
      margin: 0;
      text-align: center;
    }
    
    h1 {
      background: linear-gradient(to right, #ff6a00, #ee0979);
      color: white;
      padding: 20px;
      border-radius: 10px;
      font-size: 2em;
      font-weight: bold;
      text-align: center;
      margin-bottom: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    #resultsBox {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .result-card {
      background: #fff9c4;
      border-left: 5px solid #4caf50;
      border-radius: 8px;
      padding: 15px;
      max-width: 800px;
      margin: auto;
      font-size: 16px;
      line-height: 1.5;
      color: #333;
    }
    
    .group-section {
      margin: 30px auto;
      max-width: 95%;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .group-title {
      background: linear-gradient(to right, #42a5f5, #7e57c2);
      color: white;
      padding: 12px;
      font-size: 18px;
      font-weight: bold;
      text-align: center;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 14px;
      background: white;
    }
    
    th {
      background-color: #3949ab;
      color: white;
      padding: 10px;
      text-align: center;
      font-weight: 600;
      border: 1px solid #ccc;
    }
    
    td {
      padding: 10px;
      text-align: center;
      color: #333;
      border: 1px solid #ccc;
      background-color: #fafafa;
    }
    
    tr:nth-child(even) td {
      background-color: #f0f0f0;
    }
    
    tr:hover td {
      background-color: #e1bee7;
    }
    
    .nrr-cell {
      white-space: nowrap;
    }
    
    .knockout-section {
      margin: 30px auto;
      max-width: 95%;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
      overflow: hidden;
      transition: transform 0.2s ease;
      border: 1px solid #e0e0e0;
    }
    
    .knockout-section:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2);
    }
    
    .knockout-title {
      background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 50%, #1f1f1f 100%);
      color: #ffffff;
      padding: 20px;
      font-size: 24px;
      font-weight: 700;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 2px;
      position: relative;
      overflow: hidden;
      border-bottom: 3px solid #ffd700;
    }
    
    .knockout-title::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,215,0,0.3), transparent);
      animation: shine 4s infinite;
    }
    
    .knockout-section table {
      background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
    }
    
    .knockout-section th {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: #ffffff;
      padding: 15px 12px;
      text-align: center;
      font-weight: 700;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      border: none;
      border-right: 1px solid rgba(255,255,255,0.1);
    }
    
    .knockout-section th:last-child {
      border-right: none;
    }
    
    .qualified-row {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
      color: #2c3e50 !important;
      font-weight: 600;
      animation: none;
      border-left: 4px solid #ffd700;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    
    .qualified-row td {
      background: transparent !important;
      color: #2c3e50 !important;
      font-weight: 600;
      padding: 15px 12px;
      border-right: 1px solid rgba(0,0,0,0.05);
      font-size: 14px;
    }
    
    .qualified-row:hover {
      background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%) !important;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.12);
    }
    
    .qualified-row:hover td {
      background: transparent !important;
      color: #1565c0 !important;
    }
    
    .qualified-row td:first-child {
      font-weight: 800;
      font-size: 16px;
      color: #ff6f00 !important;
    }
    
    .qualified-row td:nth-child(2) {
      font-weight: 700;
      font-size: 15px;
      color: #1565c0 !important;
    }
    
    @keyframes shine {
      0% { left: -100%; }
      100% { left: 100%; }
    }
    
    .playoff-section {
      margin: 30px auto;
      max-width: 95%;
      border-radius: 20px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
      background: linear-gradient(145deg, #0a0e27 0%, #1a1f3a 50%, #2a2d47 100%);
      padding: 30px;
      transition: transform 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    
    .playoff-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #ff6f00, #ffc107, #ff5722, #e91e63, #9c27b0, #3f51b5, #2196f3);
      animation: rainbow 3s linear infinite;
    }
    
    @keyframes rainbow {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
    
    .playoff-section:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
    }
    
    .playoff-title {
      background: linear-gradient(135deg, #ff6f00 0%, #ffc107 50%, #ff8f00 100%);
      color: white;
      padding: 20px;
      font-size: 28px;
      font-weight: 900;
      text-align: center;  
      border-radius: 15px;
      margin-bottom: 35px;
      text-transform: uppercase;
      letter-spacing: 3px;
      box-shadow: 0 8px 25px rgba(255, 111, 0, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .playoff-title::before {
      content: 'üèÜ';
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 32px;
      animation: bounce 2s infinite;
    }
    
    .playoff-title::after {
      content: 'üèÜ';
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 32px;
      animation: bounce 2s infinite 0.5s;
    }
    
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(-50%) scale(1); }
      40% { transform: translateY(-60%) scale(1.1); }
      60% { transform: translateY(-55%) scale(1.05); }
    }
    
    .bracket-round {
      margin-bottom: 40px;
      position: relative;
    }
    
    .bracket-round::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #ff6f00, #ffc107);
      border-radius: 2px;
    }
    
    .bracket-round h3 {
      color: #ffffff;
      font-size: 24px;
      margin-bottom: 25px;
      text-align: center;
      padding: 18px 25px;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      border-radius: 12px;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 800;
      border: 2px solid #ffc107;
      box-shadow: 0 6px 20px rgba(30, 60, 114, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .bracket-round h3::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,193,7,0.3), transparent);
      animation: shine 3s infinite;
    }
    
    .bracket-matches {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 25px;
      perspective: 1000px;
    }
    
    .bracket-match {
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      font-weight: 700;
      font-size: 16px;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      transform-style: preserve-3d;
      border: 2px solid transparent;
    }
    
    .bracket-match::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: inherit;
      border-radius: 15px;
      filter: blur(20px);
      opacity: 0.7;
      z-index: -1;
      transform: scale(1.05);
      transition: all 0.4s ease;
    }
    
    .bracket-match:hover {
      transform: translateY(-8px) rotateX(5deg);
      z-index: 10;
    }
    
    .bracket-match:hover::before {
      filter: blur(25px);
      opacity: 0.9;
      transform: scale(1.1);
    }
    
    .bracket-match.quarterfinal {
      background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 50%, #4caf50 100%);
      color: white;
      border: 2px solid #66bb6a;
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }
    
    .bracket-match.quarterfinal:hover {
      box-shadow: 0 15px 35px rgba(76, 175, 80, 0.6);
      border-color: #81c784;
    }
    
    .bracket-match.semifinal {
      background: linear-gradient(135deg, #e65100 0%, #f57c00 50%, #ff9800 100%);
      color: white;
      border: 2px solid #ffb74d;
      box-shadow: 0 6px 20px rgba(255, 152, 0, 0.4);
    }
    
    .bracket-match.semifinal:hover {
      box-shadow: 0 15px 35px rgba(255, 152, 0, 0.6);
      border-color: #ffcc02;
    }
    
    .bracket-match.final {
      background: linear-gradient(135deg, #b71c1c 0%, #d32f2f 50%, #f44336 100%);
      color: white;
      border: 3px solid #ef5350;
      box-shadow: 0 8px 25px rgba(244, 67, 54, 0.5);
      font-size: 20px;
      padding: 25px;
      position: relative;
    }
    
    .bracket-match.final::after {
      content: 'üëë';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 24px;
      animation: rotate 3s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .bracket-match.final:hover {
      box-shadow: 0 15px 40px rgba(244, 67, 54, 0.7);
      border-color: #ff7043;
    }
    
    .match-vs {
      font-size: 14px;
      opacity: 0.8;
      margin: 8px 0;
      text-transform: lowercase;
      font-weight: 400;
    }
    
    .team-name {
      font-size: 18px;
      font-weight: 800;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    @media screen and (max-width: 768px) {
      body {
        padding: 5px;
      }
      h1 {
        font-size: 1.4em;
        padding: 15px;
      }
      .group-title {
        font-size: 16px;
      }
      table, th, td {
        font-size: 12px;
        padding: 6px;
      }
      .bracket-matches {
        grid-template-columns: 1fr;
      }
      .knockout-title, .playoff-title {
        font-size: 16px;
      }
    }
    
    @media screen and (max-width: 600px) {
      .result-card {
        font-size: 13px;
        padding: 10px;
      }
      table, th, td {
        font-size: 12px;
      }
      .group-title {
        font-size: 16px;
      }
    }
    
/* IPL-style enhancements for group tables */
.group-section table {
  border: 2px solid #673ab7;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(103, 58, 183, 0.3);
}

.group-section th {
  background: linear-gradient(to right, #512da8, #673ab7);
  color: white;
  text-transform: uppercase;
  font-size: 13px;
  padding: 10px;
  letter-spacing: 1px;
}

.group-section td {
  font-size: 13px;
  background: #f3e5f5;
  color: #311b92;
  padding: 8px;
}

.top-team-row {
  background: #d1c4e9 !important;
  font-weight: bold;
  color: #4a148c !important;
}

.bottom-team-row {
  background: #ffebee !important;
  color: #b71c1c !important;
  font-weight: 500;
}

/* Mobile responsiveness */
@media screen and (max-width: 768px) {
  .group-section table, .group-section th, .group-section td {
    font-size: 12px;
    padding: 6px;
  }
}

/* Knockout table fit-to-screen on all devices */
.knockout-section table {
  width: 100%;
  table-layout: fixed;
}

/* Consistent row heights */
.group-section table td, .group-section table th,
.knockout-section table td, .knockout-section table th {
  height: 40px;
  vertical-align: middle;
}

/* Top teams pastel blue highlight */
.qualified-row {
  background: #d6eaf8 !important;
  color: #154360 !important;
  font-weight: 600;
}

/* Mobile knockout table fix */
@media screen and (max-width: 768px) {
  .knockout-section table,
  .knockout-section th,
  .knockout-section td {
    font-size: 11px;
    padding: 4px;
    word-wrap: break-word;
    white-space: normal;
  }
}


/* Allow longer team names in knockout */
.knockout-section td:nth-child(2),
.knockout-section th:nth-child(2) {
  min-width: 110px;
  max-width: 150px;
  word-wrap: break-word;
  white-space: normal;
}

</style>
</head>
<body>

<h1>Virginia Legends Cricket 2025</h1>
<div id="lastUpdated" style="text-align: center; color: #666; font-size: 14px; margin-bottom: 20px;"></div>

<div id="resultsBox">No results yet</div>
<div id="tables"></div>

<div id="knockoutSection"></div>
<div id="playoffBrackets"></div>

<section id="upload-section">
</section>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<script>
    let allResults = [];
    let resultIndex = 0;
    let scrollInterval;

    function loadResults() {
      const input = document.getElementById("resultsFileInput");
      if (!input.files.length) {
        alert("Please select a match results CSV file.");
        return;
      }

      Papa.parse(input.files[0], {
        header: true,
        skipEmptyLines: true,
        complete: function(results) {
          const data = results.data;
          allResults = [];

          data.forEach(row => {
            const line = `üèè <strong>Group ${row['Group'] || ''}</strong> ‚Äì
              <strong>${row['Team1'] || ''}</strong> ${row['Team1 Runs'] || 0}/${row['Wickets'] ?? '--'} (${(row['Overs'] ? parseFloat(row['Overs']).toFixed(1) : '--')} ov)
              vs
              <strong>${row['Team2'] || ''}</strong> ${row['Team2 Runs'] || 0}/${row['Wickets_1'] ?? '--'} (${(row['Overs_1'] ? parseFloat(row['Overs_1']).toFixed(1) : '--')} ov)
              ‚Äî Result: <strong>${row['Result'] || 'N/A'}</strong>`;
            allResults.push(line);
          });

          resultIndex = 0;
          displayNextResults();
          if (scrollInterval) clearInterval(scrollInterval);
          scrollInterval = setInterval(displayNextResults, 10000);
        }
      });
    }

    function displayNextResults() {
      const box = document.getElementById("resultsBox");
      if (allResults.length === 0) {
        box.innerHTML = "No match data available.";
        return;
      }

      let html = "";
      for (let i = 0; i < 2; i++) {
        const idx = (resultIndex + i) % allResults.length;
        html += `<div>${allResults[idx]}</div>`;
      }

      resultIndex = (resultIndex + 2) % allResults.length;
      
    let wrappedHTML = allResults.slice(resultIndex, resultIndex + 2).map(result => `
      <div class="result-card">
        ${result}
      </div>
    `).join('');
    box.innerHTML = wrappedHTML;
    
    }
  </script>
<script>
  function loadCSV() {
    const input = document.getElementById('csvFileInput');
    if (!input.files.length) {
      alert('Please select a CSV file.');
      return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
      const text = e.target.result;
      const rows = text.trim().split('\n').map(row => row.split(','));
      const headers = rows[0];
      const groupIndex = headers.indexOf("Group");
      const teamIndex = headers.indexOf("Team");
      const pointsIndex = headers.indexOf("Points");
      const nrrIndex = headers.indexOf("NRR");

      const visibleHeaders = headers.filter((_, i) => i !== groupIndex);
      const groupData = {};
      for (let i = 1; i < rows.length; i++) {
        const row = rows[i];
        const group = row[groupIndex];
        if (!groupData[group]) groupData[group] = [];
        groupData[group].push(row);
      }

      const tablesDiv = document.getElementById('tables');
      tablesDiv.innerHTML = '';

      for (const group in groupData) {
        const rows = groupData[group];
        rows.sort((a, b) => {
          let pointsDiff = parseInt(b[pointsIndex]) - parseInt(a[pointsIndex]);
          if (pointsDiff !== 0) return pointsDiff;
          return parseFloat(b[nrrIndex]) - parseFloat(a[nrrIndex]);
        });

        
    const topTeamNames = new Set([rows[0][teamIndex], rows[1]?.[teamIndex] || ""]);
    const medalMap = {};
    medalMap[rows[0][teamIndex]] = "ü•á ";
    if (rows.length > 1) {
      medalMap[rows[1][teamIndex]] = "ü•à ";
    }
    
        const bottomTeamNames = new Set([
          rows[rows.length - 1]?.[teamIndex],
          rows[rows.length - 2]?.[teamIndex]
        ]);

        let html = '<div class="group-section">';
        html += '<div class="group-title">Group ' + group + '</div>';
        html += '<div style="overflow-x:auto;"><table><thead><tr>';
        visibleHeaders.forEach(h => html += '<th>' + h + '</th>');
        html += '</tr></thead><tbody>';

        rows.forEach(row => {
          const team = row[teamIndex];
          let rowClass = '';
          if (topTeamNames.has(team)) rowClass = 'top-team-row';
          else if (bottomTeamNames.has(team)) rowClass = 'bottom-team-row';

          html += `<tr class="${rowClass}">`;
          row.forEach((cell, i) => {
            if (i !== groupIndex) {
              let cellContent = cell;
              if (headers[i] === "NRR") {
                cellContent = parseFloat(cell).toFixed(3);
              }
              
    if (headers[i] === "NRR") {
      html += `<td class='nrr-cell'>${cellContent}</td>`;
    } else {
      html += `<td>${cellContent}</td>`;
    }
    
            }
          });
          html += '</tr>';
        });

        html += '</tbody></table></div></div></div>';
        tablesDiv.innerHTML += html;
      }
    };
    reader.readAsText(input.files[0]);
  }
</script>
    
<script>
  function fetchAndLoadCSV() {
    // Update timestamp
    const now = new Date();
    document.getElementById('lastUpdated').innerHTML = `Last Updated: ${now.toLocaleString()} <button style="margin-left:10px; background:red; color:white; border:none; padding:4px 8px; border-radius:4px; font-weight:bold;">LIVE</button>`;
    
    fetch('https://raw.githubusercontent.com/Wick1366/solid-robot/main/tournament_results.csv')
      .then(response => response.text())
      .then(text => {
        const rows = text.trim().split('\n').map(row => row.split(','));
        const headers = rows[0];
        const groupIndex = headers.indexOf("Group");
        const teamIndex = headers.indexOf("Team");
        const pointsIndex = headers.indexOf("Points");
        const nrrIndex = headers.indexOf("NRR");

        const visibleHeaders = headers.filter((_, i) => i !== groupIndex);
        const groupData = {};
        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];
          const group = row[groupIndex];
          if (!groupData[group]) groupData[group] = [];
          groupData[group].push(row);
        }

        // Generate knockout table and brackets
        generateKnockoutStage(groupData, headers, teamIndex, pointsIndex, nrrIndex);

        const tablesDiv = document.getElementById('tables');
        tablesDiv.innerHTML = '';

        for (const group in groupData) {
          const rows = groupData[group];
          rows.sort((a, b) => {
            let pointsDiff = parseInt(b[pointsIndex]) - parseInt(a[pointsIndex]);
            if (pointsDiff !== 0) return pointsDiff;
            return parseFloat(b[nrrIndex]) - parseFloat(a[nrrIndex]);
          });

          const topTeamNames = new Set([rows[0][teamIndex], rows[1]?.[teamIndex] || ""]);
          const bottomTeamNames = new Set([
            rows[rows.length - 1]?.[teamIndex],
            rows[rows.length - 2]?.[teamIndex]
          ]);

          let html = '<div class="group-section">';
          html += '<div class="group-title">Group ' + group + '</div>';
          html += '<div style="overflow-x:auto;"><table><thead><tr>';
          visibleHeaders.forEach(h => html += '<th>' + h + '</th>');
          html += '</tr></thead><tbody>';

          rows.forEach((row, index) => {
            const team = row[teamIndex];
            let rowClass = '';
            if (index < 2) rowClass = 'qualified-row'; // Top 2 qualify
            else if (topTeamNames.has(team)) rowClass = 'top-team-row';
            else if (bottomTeamNames.has(team)) rowClass = 'bottom-team-row';

            html += `<tr class="${rowClass}">`;
            row.forEach((cell, i) => {
              if (i !== groupIndex) {
                let cellContent = cell;
                if (headers[i] === "NRR") {
                  cellContent = parseFloat(cell).toFixed(3);
                }
                if (headers[i] === "NRR") {
                  html += `<td class='nrr-cell'>${cellContent}</td>`;
                } else {
                  html += `<td>${cellContent}</td>`;
                }
              }
            });
            html += '</tr>';
          });

          html += '</tbody></table></div></div></div>';
          tablesDiv.innerHTML += html;
        }
      });

    fetch('https://raw.githubusercontent.com/Wick1366/solid-robot/main/match_scores.csv')
      .then(response => response.text())
      .then(text => {
        const data = Papa.parse(text, { header: true, skipEmptyLines: true }).data;
        const box = document.getElementById("resultsBox");

        if (!data.length) {
          box.innerHTML = "No match data available.";
          return;
        }

        const results = data.map(row => `
          <div class="result-card">
            üèè <strong>Group ${row['Group'] || ''}</strong> ‚Äì
            <strong>${row['Team1'] || ''}</strong> ${row['Team1 Runs'] || 0}/${row['Wickets'] ?? '--'} (${(row['Overs'] ? parseFloat(row['Overs']).toFixed(1) : '--')} ov)
            vs
            <strong>${row['Team2'] || ''}</strong> ${row['Team2 Runs'] || 0}/${row['Wickets_1'] ?? '--'} (${(row['Overs_1'] ? parseFloat(row['Overs_1']).toFixed(1) : '--')} ov)
            ‚Äî Result: <strong>${row['Result'] || 'N/A'}</strong>
          </div>
        `).join('');

        box.innerHTML = results;
      });
  }

  window.onload = fetchAndLoadCSV;
  setInterval(fetchAndLoadCSV, 60000); // every 60 seconds
  
  function generateKnockoutStage(groupData, headers, teamIndex, pointsIndex, nrrIndex) {
    const qualifiedTeams = [];
    
    // Get top 2 from each group
    for (const group in groupData) {
      const rows = groupData[group];
      rows.sort((a, b) => {
        let pointsDiff = parseInt(b[pointsIndex]) - parseInt(a[pointsIndex]);
        if (pointsDiff !== 0) return pointsDiff;
        return parseFloat(b[nrrIndex]) - parseFloat(a[nrrIndex]);
      });
      
      // Add top 2 teams with their group info
      if (rows[0]) qualifiedTeams.push({...rows[0], group: group, position: 1});
      if (rows[1]) qualifiedTeams.push({...rows[1], group: group, position: 2});
    }
    
    // Sort qualified teams by points, then NRR
    qualifiedTeams.sort((a, b) => {
      let pointsDiff = parseInt(b[pointsIndex]) - parseInt(a[pointsIndex]);
      if (pointsDiff !== 0) return pointsDiff;
      return parseFloat(b[nrrIndex]) - parseFloat(a[nrrIndex]);
    });
    
    // Generate knockout table
    generateKnockoutTable(qualifiedTeams, headers, teamIndex, pointsIndex, nrrIndex);
    
    // Generate playoff brackets
    generatePlayoffBrackets(qualifiedTeams, teamIndex);
  }
  
  function generateKnockoutTable(teams, headers, teamIndex, pointsIndex, nrrIndex) {
    const knockoutDiv = document.getElementById('knockoutSection');
    
    let html = '<div class="knockout-section">';
    html += '<div class="knockout-title">üèè Knockout Stage ‚Äì Current Standings & Brackets</div>';
    html += '<div style="overflow-x:auto;"><table><thead><tr>';
    html += '<th>Rank</th><th style="min-width: 110px;">Team</th><th>P</th><th>W</th><th>L</th><th>Pts</th><th>NRR</th>';
    html += '</tr></thead><tbody>';
    
    teams.forEach((team, index) => {
      html += `<tr class="qualified-row">`;
      html += `<td><strong>${index + 1}</strong></td>`;
      html += `<td><strong>${team[teamIndex]}</strong></td>`;
      html += ``;
      
      // Find the correct column indices - trying common variations
      const playedIndex = headers.indexOf("Mat");
      const wonIndex = headers.indexOf("W");
      const lostIndex = headers.indexOf("L");
      
      html += `<td>${playedIndex >= 0 ? team[playedIndex] : 'N/A'}</td>`;
      html += `<td>${wonIndex >= 0 ? team[wonIndex] : 'N/A'}</td>`;
      html += `<td>${lostIndex >= 0 ? team[lostIndex] : 'N/A'}</td>`;
      html += `<td>${team[pointsIndex]}</td>`;
      html += `<td class="nrr-cell">${parseFloat(team[nrrIndex]).toFixed(3)}</td>`;
      html += '</tr>';
    });
    
    html += '</tbody></table></div></div>';
    knockoutDiv.innerHTML = html;
  }
  
  function generatePlayoffBrackets(teams, teamIndex) {
    const bracketsDiv = document.getElementById('playoffBrackets');
    
    let html = '<div class="playoff-section">';
    html += '<div class="playoff-title">Playoff Brackets</div>';
    
    // Quarter Finals
    html += '<div class="bracket-round">';
    html += '<h3>‚ö° Quarter Finals</h3>';
    html += '<div class="bracket-matches">';
    
    if (teams.length >= 8) {
      html += `<div class="bracket-match quarterfinal">
        <div class="team-name">${teams[0][teamIndex]}</div>
        <div class="match-vs">vs</div>
        <div class="team-name">${teams[7][teamIndex]}</div>
        <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">QF1</div>
      </div>`;
      html += `<div class="bracket-match quarterfinal">
        <div class="team-name">${teams[1][teamIndex]}</div>
        <div class="match-vs">vs</div>
        <div class="team-name">${teams[6][teamIndex]}</div>
        <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">QF2</div>
      </div>`;
      html += `<div class="bracket-match quarterfinal">
        <div class="team-name">${teams[2][teamIndex]}</div>
        <div class="match-vs">vs</div>
        <div class="team-name">${teams[5][teamIndex]}</div>
        <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">QF3</div>
      </div>`;
      html += `<div class="bracket-match quarterfinal">
        <div class="team-name">${teams[3][teamIndex]}</div>
        <div class="match-vs">vs</div>
        <div class="team-name">${teams[4][teamIndex]}</div>
        <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">QF4</div>
      </div>`;
    }
    
    html += '</div></div>';
    
    // Semi Finals
    html += '<div class="bracket-round">';
    html += '<h3>üî• Semi Finals</h3>';
    html += '<div class="bracket-matches">';
    html += `<div class="bracket-match semifinal">
      <div class="team-name">Winner QF1</div>
      <div class="match-vs">vs</div>
      <div class="team-name">Winner QF4</div>
      <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">SF1</div>
    </div>`;
    html += `<div class="bracket-match semifinal">
      <div class="team-name">Winner QF2</div>
      <div class="match-vs">vs</div>
      <div class="team-name">Winner QF3</div>
      <div style="margin-top: 10px; font-size: 12px; opacity: 0.8;">SF2</div>
    </div>`;
    html += '</div></div>';
    
    // Final
    html += '<div class="bracket-round">';
    html += '<h3>üëë Grand Final</h3>';
    html += '<div class="bracket-matches">';
    html += `<div class="bracket-match final">
      <div class="team-name">Winner SF1</div>
      <div class="match-vs">vs</div>
      <div class="team-name">Winner SF2</div>
      <div style="margin-top: 15px; font-size: 14px; opacity: 0.9; letter-spacing: 2px;">üèÜ CHAMPION üèÜ</div>
    </div>`;
    html += '</div></div>';
    
    html += '</div>';
    bracketsDiv.innerHTML = html;
  }
</script>

</body>
</html>
